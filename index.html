<!DOCTYPE html>
<html lang="hi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>ग्राम शक्ति - गाँव की डिजिटल सेवा | Gram Shakti Official</title>
<meta name="description" content="ग्राम शक्ति (Gram Shakti): आपके गाँव के सभी वर्कर्स, जेसीबी, मिस्त्री और मजदूरों को खोजने का सबसे बड़ा प्लेटफॉर्म।">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Devanagari:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  body { 
    background: linear-gradient(to bottom right, #fdf4eb, #fffde7, #e0f2fe);
    font-family: 'Noto Sans Devanagari', 'Poppins', sans-serif;
    min-height: 100vh; display: flex; flex-direction: column; align-items: center; padding: 20px;
  }
  .app-card {
    background: white; width: 100%; max-width: 480px; padding: 30px; border-radius: 20px;
    box-shadow: 0 15px 30px rgba(0,0,0,0.1); z-index: 10;
  }
  .ad-space {
    width: 100%; max-width: 480px; background: rgba(0,0,0,0.05);
    border: 1px dashed #ccc; margin: 10px 0; display: flex;
    align-items: center; justify-content: center; color: #888;
    font-size: 12px; border-radius: 10px; min-height: 60px;
  }
  .btn-primary {
    width: 100%; padding: 16px; background: linear-gradient(90deg, #f97316, #ea580c);
    color: white; border-radius: 14px; font-size: 18px; font-weight: 700;
    margin-top: 15px; cursor: pointer; box-shadow: 0 8px 20px rgba(249, 115, 22, 0.4);
  }
  #adminLogo {
    background: #2563eb; color: white; width: 44px; height: 44px;
    border-radius: 50%; display: flex; align-items: center; justify-content: center;
    font-size: 22px; font-weight: bold; cursor: pointer; 
  }
  .header-logo { font-family: 'Poppins', sans-serif; font-weight: 700; color: #f97316; font-size: 2rem; }
.back-btn {
    position: fixed;
    top: 15px;
    left: 10px;
    background: #2563eb;
    color: white;
    padding: 8px 15px;
    border-radius: 25px;
    display: flex;
    align-items: center;
    justify-content: center;
    border: none;
    font-size: 16px;
    font-weight: bold;
    z-index: 10000;
    box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    cursor: pointer;
}

</style>
</head>
<body>
<button <a href="#" onclick="history.back(); return false;" class="back-btn">
    &#8592; Back
</a>
</button>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (1).png" alt="Gram Shakti App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>

  <div id="app-container" class="app-card">
    </div>

  <div style="text-align: center; margin: 15px 0;">
    <a href="https://github.com/gram-shakti-official/gram-shakti/releases/download/V1/gramshakti.apk">
        <img src="1770902092682 (2).png" alt="Install App" style="width: 100%; max-width: 480px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.3);">
    </a>
</div>
<script>
// 1. Firebase सेटअप (आपका पुराना कॉन्फिग)
const firebaseConfig = {
  apiKey: "AIzaSyCuvev3-jwZwQuO_fHYyv2E2ovLny4Lh8Q",
  authDomain: "gram-shakti-b135a.firebaseapp.com",
  databaseURL: "https://gram-shakti-b135a-default-rtdb.firebaseio.com",
  projectId: "gram-shakti-b135a"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// डेटा सेव करने के लिए ऑब्जेक्ट
let userFlow = { state: '', jila: '', panchayat: '', village: '' };

// 2. बैक बटन का स्मार्ट फंक्शन
function goBack() {
    if (document.getElementById('distSelect') || document.getElementById('distInp')) { showStates(); }
    else if (document.getElementById('panchSelect') || document.getElementById('panchInp')) { showDistrictStep(); }
    else if (document.getElementById('villSelect') || document.getElementById('villInp')) { showPanchayatStep(); }
    else { location.reload(); }
}

// 3. राज्यों का शानदार डिजाइन (Main Screen)
function showStates() {
    const states = ['Uttar Pradesh', 'Bihar', 'Rajasthan', 'Madhya Pradesh', 'Haryana', 'Uttarakhand', 'Jharkhand', 'Delhi', 'Punjab', 'Gujarat'];
    let container = document.getElementById('app-container');
    
    let html = `
        <h1 style="text-align:center; color:#f97316; font-size:30px; margin-bottom:10px; text-shadow: 1px 1px 2px #ccc;">ग्राम शक्ति</h1>
        <p style="text-align:center; color:#666; font-weight:bold; margin-bottom:20px;">अपना राज्य चुनकर आगे बढ़ें</p>
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; padding:10px; max-height:450px; overflow-y:auto;">`;

    states.forEach(s => {
        html += `
            <div onclick="userFlow.state='${s}'; showDistrictStep()" 
                 style="background: white; 
                        border-bottom: 4px solid #f97316; 
                        padding: 25px 10px; 
                        border-radius: 20px; 
                        cursor: pointer; 
                        text-align: center; 
                        font-weight: 800; 
                        color: #333;
                        box-shadow: 0 10px 20px rgba(0,0,0,0.1);
                        display: flex; align-items: center; justify-content: center;
                        font-size: 14px;
                        transition: all 0.3s ease;">
                 ${s}
            </div>`;
    });
    
    html += `</div>`;
    container.innerHTML = html;
}

// 4. जिला चुनने वाला पेज (Smart List)
function showDistrictStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <div style="padding:10px;">
            <h3 style="color:#f97316;">${userFlow.state} > जिला चुनें</h3>
            <select id="distSelect" style="width:100%; padding:15px; border-radius:15px; border:2px solid #f97316; margin:15px 0; font-weight:bold; outline:none;" onchange="userFlow.jila = this.value">
                <option value="">-- पुराना जिला चुनें --</option>
            </select>
            <div onclick="document.getElementById('distInp').style.display='block'; this.style.display='none'" style="color:#2563eb; font-weight:bold; cursor:pointer; margin-bottom:10px;">+ नया जिला जोड़ें</div>
            <input type="text" id="distInp" placeholder="यहाँ नये जिले का नाम लिखें" style="display:none; width:100%; padding:15px; border-radius:15px; border:1px solid #ccc; margin-bottom:15px;">
            <button onclick="saveDistrict()" style="width:100%; padding:15px; background:#f97316; color:white; border:none; border-radius:15px; font-size:18px; font-weight:bold; box-shadow: 0 5px 15px rgba(249,115,22,0.4);">आगे बढ़ें</button>
        </div>`;

    db.ref('users/').once('value', (snapshot) => {
        let distSet = new Set();
        snapshot.forEach(child => { if(child.val().state === userFlow.state) distSet.add(child.val().jila); });
        let select = document.getElementById('distSelect');
        distSet.forEach(d => { if(d) select.innerHTML += `<option value="${d}">${d}</option>`; });
    });
}

function saveDistrict() {
    let inp = document.getElementById('distInp').value;
    if(inp) userFlow.jila = inp; 
    if(!userFlow.jila) { alert("कृपया जिला चुनें या लिखें"); return; }
    showPanchayatStep();
}

// 5. पंचायत चुनने वाला पेज
function showPanchayatStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <div style="padding:10px;">
            <h3 style="color:#f97316;">${userFlow.jila} > पंचायत चुनें</h3>
            <select id="panchSelect" style="width:100%; padding:15px; border-radius:15px; border:2px solid #f97316; margin:15px 0; font-weight:bold;" onchange="userFlow.panchayat = this.value">
                <option value="">-- पुरानी पंचायत चुनें --</option>
            </select>
            <div onclick="document.getElementById('panchInp').style.display='block'; this.style.display='none'" style="color:#2563eb; font-weight:bold; cursor:pointer; margin-bottom:10px;">+ नई पंचायत जोड़ें</div>
            <input type="text" id="panchInp" placeholder="नयी पंचायत का नाम लिखें" style="display:none; width:100%; padding:15px; border-radius:15px; border:1px solid #ccc; margin-bottom:15px;">
            <button onclick="savePanchayat()" style="width:100%; padding:15px; background:#f97316; color:white; border:none; border-radius:15px; font-size:18px; font-weight:bold; box-shadow: 0 5px 15px rgba(249,115,22,0.4);">आगे बढ़ें</button>
        </div>`;

    db.ref('users/').once('value', (snapshot) => {
        let panchSet = new Set();
        snapshot.forEach(child => { if(child.val().jila === userFlow.jila) panchSet.add(child.val().panchayat); });
        let select = document.getElementById('panchSelect');
        panchSet.forEach(p => { if(p) select.innerHTML += `<option value="${p}">${p}</option>`; });
    });
}

function savePanchayat() {
    let inp = document.getElementById('panchInp').value;
    if(inp) userFlow.panchayat = inp;
    if(!userFlow.panchayat) { alert("कृपया पंचायत चुनें"); return; }
    showVillageStep();
}

// 6. गाँव वाला आखिरी पेज
function showVillageStep() {
    let container = document.getElementById('app-container');
    container.innerHTML = `
        <div style="padding:10px;">
            <h3 style="color:#f97316;">अपना गाँव लिखें/चुनें</h3>
            <select id="villSelect" style="width:100%; padding:15px; border-radius:15px; border:2px solid #f97316; margin:15px 0;" onchange="document.getElementById('villInp').value = this.value">
                <option value="">-- पुराना गाँव चुनें --</option>
            </select>
            <input type="text" id="villInp" placeholder="गाँव का नाम यहाँ लिखें" style="width:100%; padding:15px; border-radius:15px; border:1px solid #ccc; margin-bottom:20px;">
            <button onclick="saveFinal()" style="width:100%; padding:15px; background:#16a34a; color:white; border:none; border-radius:15px; font-size:18px; font-weight:bold; box-shadow: 0 5px 15px rgba(22,163,74,0.4);">डाटा सुरक्षित करें</button>
        </div>`;

    db.ref('users/').once('value', (snapshot) => {
        let villSet = new Set();
        snapshot.forEach(child => { if(child.val().panchayat === userFlow.panchayat) villSet.add(child.val().village); });
        let select = document.getElementById('villSelect');
        villSet.forEach(v => { if(v) select.innerHTML += `<option value="${v}">${v}</option>`; });
    });
}

function saveFinal() {
    userFlow.village = document.getElementById('villInp').value;
    if(!userFlow.village) { alert("गाँव का नाम लिखें"); return; }
    db.ref('users/').push(userFlow).then(() => {
        alert("बधाई हो! आपका डाटा 'ग्राम शक्ति' में सुरक्षित हो गया है।");
        location.reload();
    });
}

// ऐप लोड होते ही राज्य दिखाओ
showStates();
</script>
</body>
</html>
