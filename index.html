<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø - ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§≠‡§æ‡§∞‡§§</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { background:#f8fafc; font-family: 'Inter', sans-serif; }
        .card { background: white; padding: 20px; border-radius: 25px; margin-bottom: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.05); }
        .hidden { display: none !important; }
        .red-mark { border: 3px solid #ef4444 !important; background: #fee2e2 !important; }
        .input-style { @apply w-full p-4 rounded-2xl border-2 border-gray-100 bg-gray-50 font-bold focus:border-orange-500 outline-none transition-all mb-4; }
        .btn-main { @apply w-full bg-orange-600 text-white py-5 rounded-2xl font-black text-xl shadow-xl active:scale-95 transition-all uppercase italic; }
    </style>
</head>
<body class="p-4 max-w-md mx-auto">

    <div id="home-screen">
        <div class="bg-gradient-to-br from-orange-500 to-orange-700 h-[250px] rounded-[40px] p-8 flex flex-col items-center justify-center text-white text-center shadow-2xl mb-6">
            <h1 id="main-logo" class="text-5xl font-black italic tracking-tighter mb-2 cursor-pointer">‡§ó‡•ç‡§∞‡§æ‡§Æ ‡§∂‡§ï‡•ç‡§§‡§ø</h1>
            <p class="text-orange-100 text-[10px] font-bold uppercase tracking-widest">‡§µ‡§ø‡§ï‡§∏‡§ø‡§§ ‡§≠‡§æ‡§∞‡§§ ‡§ï‡•Ä ‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§™‡§π‡§ö‡§æ‡§®</p>
        </div>

        <div class="card -mt-16">
            <h2 class="text-xl font-black text-gray-800 mb-4 border-b-4 border-orange-500 inline-block">‡§≠‡§æ‡§∞‡§§ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§¨‡•á‡§π‡§§‡§∞ ‡§ï‡•ç‡§Ø‡•ã‡§Ç? üáÆüá≥</h2>
            <div class="space-y-4 text-xs mb-6">
                <div class="flex gap-3"><span>üöú</span><p><b>‡§Ü‡§§‡•ç‡§Æ‡§®‡§ø‡§∞‡•ç‡§≠‡§∞ ‡§ó‡§æ‡§Å‡§µ:</b> ‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§î‡§∞ ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§ï‡§æ ‡§∏‡•Ä‡§ß‡§æ ‡§Æ‡§ø‡§≤‡§®‡•§</p></div>
                <div class="flex gap-3"><span>üõ°Ô∏è</span><p><b>‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§æ:</b> ‡§∞‡•á‡§° ‡§Æ‡§æ‡§∞‡•ç‡§ï ‡§∏‡•á ‡§ó‡§≤‡§§ ‡§≤‡•ã‡§ó‡•ã‡§Ç ‡§ï‡•Ä ‡§§‡•Å‡§∞‡§Ç‡§§ ‡§™‡§π‡§ö‡§æ‡§®‡•§</p></div>
                <div class="flex gap-3"><span>üìà</span><p><b>‡§°‡§ø‡§ú‡§ø‡§ü‡§≤ ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§°:</b> ‡§π‡§∞ ‡§™‡§Ç‡§ö‡§æ‡§Ø‡§§ ‡§ï‡§æ ‡§π‡•Å‡§®‡§∞ ‡§Ö‡§¨ ‡§ë‡§®‡§≤‡§æ‡§á‡§®‡•§</p></div>
            </div>
            <button onclick="startApp()" class="btn-main">‡§ï‡§æ‡§Æ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•á‡§Ç ‚ùØ</button>
        </div>
    </div>

    <div id="user-flow" class="hidden">
        <div class="card">
            <h2 class="font-black text-orange-600 mb-4 uppercase text-sm italic">‡§®‡§Ø‡§æ ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£</h2>
            
            <div id="step-1">
                <select id="sState" onchange="loadDists()" class="input-style">
                    <option value="">-- ‡§∞‡§æ‡§ú‡•ç‡§Ø ‡§ö‡•Å‡§®‡•á‡§Ç --</option>
                    <option value="34">‡§â‡§§‡•ç‡§§‡§∞ ‡§™‡•ç‡§∞‡§¶‡•á‡§∂</option><option value="29">‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§®</option><option value="13">‡§π‡§∞‡§ø‡§Ø‡§æ‡§£‡§æ</option>
                </select>
                <div id="distArea" class="hidden">
                    <select id="sDist" class="input-style"></select>
                    <button onclick="goStep(2)" class="btn-main text-sm py-3">‡§Ö‡§ó‡§≤‡§æ ‡§ö‡§∞‡§£</button>
                </div>
            </div>

            <div id="step-2" class="hidden">
                <input id="uName" placeholder="‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§ï‡§æ ‡§®‡§æ‡§Æ" class="input-style">
                <input id="uFather" placeholder="‡§™‡§ø‡§§‡§æ ‡§ï‡§æ ‡§®‡§æ‡§Æ" class="input-style">
                <input id="uPhone" type="number" placeholder="‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞" class="input-style">
                <input id="uTehsil" placeholder="‡§§‡§π‡§∏‡•Ä‡§≤" class="input-style">
                <input id="uVillage" placeholder="‡§ó‡§æ‡§Å‡§µ" class="input-style">
                <button onclick="saveUser()" class="btn-main">‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç ‚úÖ</button>
            </div>
        </div>
    </div>

    <div id="list-container" class="hidden">
        <h3 class="font-black text-gray-400 text-[10px] mb-3 ml-2 uppercase tracking-widest">‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø ‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§≤‡§ø‡§∏‡•ç‡§ü</h3>
        <div id="workerList"></div>
    </div>

    <div id="admin-portal" class="hidden card bg-slate-900 text-white min-h-[500px]">
        <div class="flex justify-between items-center mb-6">
            <h2 id="adm-title" class="font-black text-orange-500 italic uppercase">Admin Control</h2>
            <button onclick="location.reload()" class="text-[10px] bg-slate-700 px-3 py-1 rounded-full uppercase">Logout</button>
        </div>
        
        <div id="super-tools" class="hidden mb-6 p-4 bg-slate-800 rounded-2xl border border-slate-700">
            <h3 class="text-[10px] font-bold text-green-500 uppercase mb-3">‡§®‡§Ø‡§æ ‡§π‡•á‡§° ‡§®‡§ø‡§Ø‡•Å‡§ï‡•ç‡§§ ‡§ï‡§∞‡•á‡§Ç</h3>
            <input id="nAdmName" placeholder="‡§®‡§æ‡§Æ" class="w-full bg-slate-700 p-2 rounded mb-2 text-xs outline-none">
            <select id="nAdmRole" class="w-full bg-slate-700 p-2 rounded mb-2 text-xs outline-none text-white">
                <option value="STATE">State Head</option><option value="DISTRICT">District Head</option>
            </select>
            <input id="nAdmArea" placeholder="‡§á‡§≤‡§æ‡§ï‡§æ (‡§ú‡•à‡§∏‡•á: ‡§∞‡§æ‡§ú‡§∏‡•ç‡§•‡§æ‡§® ‡§Ø‡§æ ‡§ú‡§Ø‡§™‡•Å‡§∞)" class="w-full bg-slate-700 p-2 rounded mb-2 text-xs outline-none">
            <input id="nAdmPass" placeholder="‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°" class="w-full bg-slate-700 p-2 rounded mb-4 text-xs outline-none">
            <button onclick="addAdmin()" class="w-full bg-blue-600 py-2 rounded font-bold text-xs uppercase">‡§ú‡•ç‡§µ‡§æ‡§á‡§® ‡§ï‡§∞‡§µ‡§æ‡§è‡§Ç +</button>
        </div>

        <div id="admin-data-list" class="space-y-3"></div>
    </div>

<script>
    // üî• Firebase Config (‡§Ö‡§™‡§®‡§æ ‡§°‡§æ‡§ü‡§æ ‡§Ø‡§π‡§æ‡§Å ‡§≠‡§∞‡•á‡§Ç)
    const firebaseConfig = { apiKey: "YOUR_KEY", authDomain: "YOUR_DOMAIN", databaseURL: "YOUR_URL", projectId: "YOUR_ID" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const MASTER_PASS = "Vikas0627";
    let clicks = 0;

    // üîê Admin Entry
    document.getElementById('main-logo').onclick = () => {
        clicks++;
        if(clicks === 5) {
            let p = prompt("‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°:");
            if(p === MASTER_PASS) { showAdmin({role: "SUPER", name: "‡§µ‡§ø‡§ï‡§æ‡§∂", area: "ALL"}); }
            else { checkOtherAdmins(p); }
            clicks = 0;
        }
    };

    function startApp() {
        document.getElementById('home-screen').classList.add('hidden');
        document.getElementById('user-flow').classList.remove('hidden');
        document.getElementById('list-container').classList.remove('hidden');
    }

    async function loadDists() {
        const sId = document.getElementById('sState').value;
        const dArea = document.getElementById('distArea');
        const dSel = document.getElementById('sDist');
        dArea.classList.remove('hidden');
        dSel.innerHTML = '<option>‡§≤‡•ã‡§° ‡§π‡•ã ‡§∞‡§π‡§æ ‡§π‡•à...</option>';
        const res = await fetch(`https://cdn-api.co-vin.in/api/v2/admin/location/districts/${sId}`);
        const data = await res.json();
        dSel.innerHTML = '<option value="">-- ‡§ú‡§ø‡§≤‡§æ ‡§ö‡•Å‡§®‡•á‡§Ç --</option>';
        data.districts.forEach(d => dSel.innerHTML += `<option value="${d.district_name}">${d.district_name}</option>`);
    }

    function goStep(n) {
        document.getElementById('step-1').classList.add('hidden');
        document.getElementById('step-2').classList.remove('hidden');
    }

    function saveUser() {
        const u = {
            state: document.getElementById('sState').options[document.getElementById('sState').selectedIndex].text,
            dist: document.getElementById('sDist').value,
            name: document.getElementById('uName').value,
            phone: document.getElementById('uPhone').value,
            village: document.getElementById('uVillage').value,
            red: false, trust: 70
        };
        db.ref("users").push(u);
        alert("‡§°‡•á‡§ü‡§æ ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§π‡•Å‡§Ü!");
        location.reload();
    }

    // üìã ‡§∞‡•Ä‡§Ø‡§≤-‡§ü‡§æ‡§á‡§Æ ‡§≤‡§ø‡§∏‡•ç‡§ü
    db.ref("users").on("value", snap => {
        const listDiv = document.getElementById('workerList');
        listDiv.innerHTML = "";
        snap.forEach(child => {
            const d = child.val();
            const id = child.key;
            listDiv.innerHTML += `
                <div class="card ${d.red ? 'red-mark' : ''}">
                    <div class="flex justify-between text-[10px] font-black uppercase text-orange-500 mb-1">
                        <span>${d.dist}</span><span>${d.red ? '‚ö†Ô∏è BLACKLISTED' : '‚≠ê VERIFIED'}</span>
                    </div>
                    <b class="text-lg">${d.name}</b>
                    <p class="text-blue-600 font-bold">üìû ${d.phone}</p>
                    <p class="text-[10px] text-gray-400 uppercase font-bold mt-1">üìç ‡§ó‡§æ‡§Å‡§µ: ${d.village}</p>
                    <button onclick="complaint('${id}')" class="mt-3 text-[10px] font-black text-red-600 border border-red-200 px-3 py-1 rounded-full uppercase">‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç</button>
                </div>`;
        });
    });

    function complaint(id) {
        let msg = prompt("‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§ï‡§æ ‡§ï‡§æ‡§∞‡§£ ‡§≤‡§ø‡§ñ‡•á‡§Ç:");
        if(msg) {
            db.ref("users/"+id).update({ red: true, complaintMsg: msg });
            alert("‡§∂‡§ø‡§ï‡§æ‡§Ø‡§§ ‡§¶‡§∞‡•ç‡§ú! ‡§µ‡§∞‡•ç‡§ï‡§∞ ‡§ï‡•ã ‡§∞‡•á‡§° ‡§Æ‡§æ‡§∞‡•ç‡§ï ‡§ï‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ‡•§");
        }
    }

    function showAdmin(adm) {
        document.getElementById('home-screen').classList.add('hidden');
        document.getElementById('user-flow').classList.add('hidden');
        document.getElementById('list-container').classList.add('hidden');
        document.getElementById('admin-portal').classList.remove('hidden');
        document.getElementById('adm-title').innerText = adm.role + " DASHBOARD";
        if(adm.role === "SUPER") document.getElementById('super-tools').classList.remove('hidden');
        
        db.ref("users").on("value", snap => {
            const admList = document.getElementById('admin-data-list');
            admList.innerHTML = "";
            snap.forEach(s => {
                const u = s.val();
                if(adm.role === "SUPER" || u.state === adm.area || u.dist === adm.area) {
                    admList.innerHTML += `
                        <div class="bg-slate-800 p-4 rounded-2xl border-l-4 ${u.red ? 'border-red-600' : 'border-green-600'}">
                            <div class="font-bold">${u.name} (${u.phone})</div>
                            <div class="text-[9px] text-slate-400 mt-1 uppercase">${u.dist} | ${u.village}</div>
                            ${u.complaintMsg ? `<div class="text-[9px] text-red-400 mt-2 bg-red-900/20 p-2 rounded">REPORT: ${u.complaintMsg}</div>` : ''}
                        </div>`;
                }
            });
        });
    }

    function addAdmin() {
        const p = document.getElementById('nAdmPass').value;
        const d = { name: document.getElementById('nAdmName').value, role: document.getElementById('nAdmRole').value, area: document.getElementById('nAdmArea').value };
        db.ref("admins/"+p).set(d);
        alert("‡§®‡§Ø‡§æ ‡§π‡•á‡§° ‡§ú‡•ã‡•ú‡§æ ‡§ó‡§Ø‡§æ!");
    }

    async function checkOtherAdmins(p) {
        const s = await db.ref("admins/"+p).once('value');
        if(s.val()) showAdmin(s.val()); else alert("‡§ó‡§≤‡§§ ‡§™‡§æ‡§∏‡§µ‡§∞‡•ç‡§°!");
    }
</script>
</body>
</html>
